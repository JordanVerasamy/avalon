{% extends "base.html" %}

{% block title %}Lobby{% endblock %}

{% block head %}
  <meta http-equiv="refresh" content="5" >
{% endblock %}

{% block nav %}
  <nav aria-label="breadcrumb" role="navigation">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{% url 'index' %}">Home</a></li>
      
      {% if is_host %}
        <li class="breadcrumb-item"><a href="{% url 'create_game' %}">Create Game</a></li>
      {% else %}
        <li class="breadcrumb-item"><a href="{% url 'join_game' %}">Join Game</a></li>
      {% endif %}
      
      <li class="breadcrumb-item"><a href="{% url 'lobby' game_id=game.id player_id=self.id %}">Lobby</a></li>
    </ol>
  </nav>
{% endblock %}

{% block content %}
{% if game.is_started %}
<a class="btn btn-success btn-lg btn-block mb-3" 
   href="{% url 'game' game_id=game.id player_id=self.id %}">Go to game</a>
{% endif %}

<p>Game code: <b>{{ game.joinable_id }}</b></p>
<p>Roles: {{ roles|join:", " }}</p>

<table class="table">
  <thead>
    <tr>
        <th>Players ({{ players|length }} total)</th>
        {% if is_host %}
        <th></th>
      {% endif %}
    </tr>
  </thead>
  <tbody>
    {% for player, is_you, player_is_host in players %}
      <tr class="{% if is_you %} table-active {% endif %}">
        <td>
          {{ player.name }}
          {% if player_is_host %}(host){% endif %}
        </td>
        <td>
            {% if is_host and not is_you and not game.is_started %}
              <a href="{% url 'kick' game_id=game.id player_id=self.id kicked_player_id=player.id %}" 
                class="close text-danger" aira-label="Close">
                <span aira-hidden="true">&times;</span>
              </a>
            {% endif %}
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

{% if is_host and not game.is_started %}
  <a class="btn btn-primary btn-lg btn-block {% if players|length < 5 %} disabled {% endif %}" 
     href="{% url 'game' game_id=game.id player_id=self.id %}">Start Game</a>
{% endif %}
{% endblock %}
